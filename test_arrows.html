<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>화살표 렌더링 테스트</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <h1>Canvas 기반 화살표 렌더링 테스트</h1>
    <div id="test-results"></div>
    
    <script>
        const resultsDiv = document.getElementById('test-results');
        
        function addResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.textContent = message;
            resultsDiv.appendChild(div);
        }
        
        // Test 1: Canvas 지원 확인
        addResult('테스트 1: Canvas 지원 확인', 'info');
        const canvas = document.createElement('canvas');
        if (canvas.getContext) {
            addResult('✅ Canvas API 지원됨', 'success');
        } else {
            addResult('❌ Canvas API 지원 안됨', 'error');
        }
        
        // Test 2: requestAnimationFrame 지원 확인
        addResult('테스트 2: requestAnimationFrame 지원 확인', 'info');
        if (window.requestAnimationFrame) {
            addResult('✅ requestAnimationFrame 지원됨', 'success');
        } else {
            addResult('❌ requestAnimationFrame 지원 안됨', 'error');
        }
        
        // Test 3: ResizeObserver 지원 확인
        addResult('테스트 3: ResizeObserver 지원 확인', 'info');
        if (window.ResizeObserver) {
            addResult('✅ ResizeObserver 지원됨', 'success');
        } else {
            addResult('⚠️ ResizeObserver 지원 안됨 (폴백 사용 가능)', 'info');
        }
        
        // Test 4: 간단한 Canvas 그리기 테스트
        addResult('테스트 4: Canvas 그리기 테스트', 'info');
        try {
            const testCanvas = document.createElement('canvas');
            testCanvas.width = 200;
            testCanvas.height = 100;
            testCanvas.style.border = '1px solid #ccc';
            
            const ctx = testCanvas.getContext('2d');
            
            // 화살표 그리기
            ctx.beginPath();
            ctx.moveTo(20, 50);
            ctx.quadraticCurveTo(100, 20, 180, 50);
            ctx.strokeStyle = '#bdbdbd';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // 화살표 머리
            const angle = Math.atan2(50 - 20, 180 - 100);
            const arrowSize = 10;
            ctx.beginPath();
            ctx.moveTo(180, 50);
            ctx.lineTo(180 - arrowSize * Math.cos(angle - Math.PI / 6), 50 - arrowSize * Math.sin(angle - Math.PI / 6));
            ctx.moveTo(180, 50);
            ctx.lineTo(180 - arrowSize * Math.cos(angle + Math.PI / 6), 50 - arrowSize * Math.sin(angle + Math.PI / 6));
            ctx.stroke();
            
            document.body.appendChild(testCanvas);
            addResult('✅ Canvas 화살표 그리기 성공', 'success');
        } catch (e) {
            addResult(`❌ Canvas 그리기 실패: ${e.message}`, 'error');
        }
        
        // Test 5: 애니메이션 테스트
        addResult('테스트 5: Canvas 애니메이션 테스트', 'info');
        try {
            const animCanvas = document.createElement('canvas');
            animCanvas.width = 200;
            animCanvas.height = 100;
            animCanvas.style.border = '1px solid #ccc';
            animCanvas.style.marginTop = '10px';
            
            const ctx = animCanvas.getContext('2d');
            let dashOffset = 0;
            
            function animate() {
                ctx.clearRect(0, 0, animCanvas.width, animCanvas.height);
                
                ctx.setLineDash([6, 3]);
                ctx.lineDashOffset = dashOffset;
                
                ctx.beginPath();
                ctx.moveTo(20, 50);
                ctx.quadraticCurveTo(100, 20, 180, 50);
                ctx.strokeStyle = '#888';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                dashOffset -= 0.5;
                if (dashOffset < -9) dashOffset = 0;
                
                requestAnimationFrame(animate);
            }
            
            animate();
            document.body.appendChild(animCanvas);
            addResult('✅ Canvas 애니메이션 성공', 'success');
        } catch (e) {
            addResult(`❌ Canvas 애니메이션 실패: ${e.message}`, 'error');
        }
        
        addResult('모든 테스트 완료!', 'info');
    </script>
</body>
</html>